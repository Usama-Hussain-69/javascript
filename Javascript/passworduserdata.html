<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <form id="myForm">
      <div>
        <input id="userName" type="text" />
      </div>

      <div>
        <input id="password" type="text" />
      </div>

      <div>
        <input id="userEmail" type="text" />
      </div>

      <button onclick="saveUser(event)">Save user</button>
    </form>

    <table id="myTable" border="1"></table>

    <script>
      let mode = "CREATE";
      let currentIndex;

      let users = [];

      //   users.forEach(function (user) {
      //     console.log(user.name);
      //   });

      // showUsers(users);

      // pure functions

      function deleteUser(evt) {
        console.log(evt);
        users.splice(evt, 1);
        showUsers(users);

        // evt.target.parentNode.parentNode.remove();
      }

      function editUser(index) {
        userName.value = users[1].name;
        password.value = users[1].password;
        userEmail.value = users[1].email;

        currentIndex = index;

        mode = "EDIT";

        // users[index].name = prompt("Enter name");
        // users[index].password = prompt("Enter password");
        // users[index].email = prompt("Enter email");

        // showUsers(users);
      }

      function showUsers(cdde) {
        myTable.innerHTML = "";
        let myIndex = 0;

        // cdde.forEach(function(user, myIndex){

        for (let user of users) {
          myTable.innerHTML +=
            "<tr> <td>" +
            user.name +
            "</td> <td>" +
            user.password +
            "</td> <td>" +
            user.email +
            '</td> <td>  <button onclick="editUser(' +
            myIndex +
            ')">Edit</button> <button onclick="deleteUser(' +
            myIndex +
            ')">Delete</button> </td> </tr>';
          myIndex++;
        }
        // });
      }

      users.forEach(function (user) {
        box.innerHTML += "<li>" + user + "</li>";
      });

      function saveUser(abc) {
        abc.preventDefault();

        if (
          userName.value == "" ||
          password.value == "" ||
          userEmail.value == ""
        ) {
          return;
        }

        if (mode == "CREATE") {
          for (let user of users) {
            if (user.email == userEmail.value) {
              return alert("user pehley se h");
            }
          }

          let user1 = {
            name: userName.value,
            password: password.value,
            email: userEmail.value,
          };

          users.push(user1);
        } else if (mode == "EDIT") {
          users[currentIndex] = {
            name: userName.value,
            password: password.value,
            email: userEmail.value,
          };

          mode = "CREATE";
        }

        myForm.reset();
        showUsers(users);
      }
    </script>
  </body>
</html>
